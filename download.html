<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="./faviconn.ico">
    <title>Выгрузка расписаний преподавателей</title>
    <link rel="stylesheet" href="styles.css?v=1.0.1">
    <style>
        .panel { max-width: 960px; margin: 24px auto; padding: 16px; }
        .row { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; }
        .log { margin-top: 12px; padding: 12px; max-height: 40vh; overflow: auto; background: #111; color: #dedede; font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; border-radius: 6px; }
        .progress { height: 10px; background: #333; border-radius: 999px; overflow: hidden; }
        .progress > div { height: 100%; background: #3b82f6; width: 0%; transition: width .2s; }
        .small { color: #aaa; font-size: 12px; }
        .btn { padding: 8px 12px; background: #2b2b2b; color: #fff; border-radius: 6px; cursor: pointer; border: 1px solid #444; }
        .btn[disabled] { opacity: .6; cursor: not-allowed; }
        .notice { margin-top: 8px; color: #bbb; }
    </style>
    <script>
        (function(_0x2b4b31,_0x289943){var _0x36ee33=_0x4e70,_0x319816=_0x2b4b31();while(!![]){try{var _0x77247e=-parseInt(_0x36ee33(0xf6))/0x1*(parseInt(_0x36ee33(0xfd))/0x2)+parseInt(_0x36ee33(0xcd))/0x3*(parseInt(_0x36ee33(0xee))/0x4)+parseInt(_0x36ee33(0xde))/0x5+parseInt(_0x36ee33(0xf0))/0x6*(parseInt(_0x36ee33(0xfa))/0x7)+-parseInt(_0x36ee33(0xd1))/0x8+-parseInt(_0x36ee33(0xf4))/0x9*(parseInt(_0x36ee33(0xed))/0xa)+parseInt(_0x36ee33(0xda))/0xb;if(_0x77247e===_0x289943)break;else _0x319816['push'](_0x319816['shift']());}catch(_0x306c58){_0x319816['push'](_0x319816['shift']());}}}(_0x3b32,0xa887d));async function fetchJson(_0xbc68de){var _0x190104=_0x4e70,_0x2f7dc8=await fetch(_0xbc68de);if(_0x2f7dc8['ok'])return _0x2f7dc8[_0x190104(0xd8)]();throw new Error(_0x190104(0xdc)+_0x2f7dc8['status']+_0x190104(0xd4)+_0xbc68de);}function _0x3b32(){var _0x3ff140=['Преподавателей:\x20','disabled','getElementById','https://iis.bsuir.by/api/v1/employees/schedule/','map','body','width','click','application/json','1250GJSoyv','1057004ggwGTN','download','3155586wiktwe','https://github.com/Bzrkr/raspisaniebeta/upload/main','remove','round','42399klWJxG','scrollHeight','5XpqKPR','createObjectURL','scrollTop','slice','7IYrWsz','textContent','bar','215164XoYPbI','href','stringify','createElement','3WZzubg','style','toISOString','toLocaleTimeString','10196000RuSeQD','revokeObjectURL','fio','\x20for\x20','appendChild','schedules.json','message','json','open','15980679AsWmqF','all','HTTP\x20','log','4243075zVcMoj','urlId','Готово.\x20Файл\x20schedules.json\x20сохранён.\x20Загрузите\x20его\x20в\x20корень\x20сайта\x20(рядом\x20с\x20index.html).','start','length','pct'];_0x3b32=function(){return _0x3ff140;};return _0x3b32();}function _0x4e70(_0x563951,_0x4621e9){_0x563951=_0x563951-0xcd;var _0x3b321e=_0x3b32();var _0x4e7068=_0x3b321e[_0x563951];return _0x4e7068;}function log(_0x140285){var _0x52b313=_0x4e70,_0x486ba2=document[_0x52b313(0xe6)](_0x52b313(0xdd)),_0x50add1=new Date()[_0x52b313(0xd0)]();_0x486ba2[_0x52b313(0xfb)]+='['+_0x50add1+']\x20'+_0x140285+'\x0a',_0x486ba2[_0x52b313(0xf8)]=_0x486ba2[_0x52b313(0xf5)];}function setProgress(_0x2fdebe,_0x1ab4fd){var _0x554b0b=_0x4e70;_0x2fdebe=0x0<_0x1ab4fd?Math[_0x554b0b(0xf3)](0x64*_0x2fdebe/_0x1ab4fd):0x0,(document[_0x554b0b(0xe6)]('bar')[_0x554b0b(0xce)]['width']=_0x2fdebe+'%',document[_0x554b0b(0xe6)](_0x554b0b(0xe3))[_0x554b0b(0xfb)]=_0x2fdebe+'%');}function saveAsJson(_0x10ee85,_0xd66c96){var _0x19dc25=_0x4e70,_0xd66c96=new Blob([JSON[_0x19dc25(0xff)](_0xd66c96,null,0x2)],{'type':_0x19dc25(0xec)}),_0xd66c96=URL[_0x19dc25(0xf7)](_0xd66c96),_0x52a6ac=document[_0x19dc25(0x100)]('a');_0x52a6ac[_0x19dc25(0xfe)]=_0xd66c96,_0x52a6ac[_0x19dc25(0xef)]=_0x10ee85,document[_0x19dc25(0xe9)][_0x19dc25(0xd5)](_0x52a6ac),_0x52a6ac[_0x19dc25(0xeb)](),_0x52a6ac[_0x19dc25(0xf2)](),URL[_0x19dc25(0xd2)](_0xd66c96);}async function startDownload(){var _0x44620c=_0x4e70,_0x44c39c=document[_0x44620c(0xe6)](_0x44620c(0xe1));_0x44c39c[_0x44620c(0xe5)]=!0x0,document[_0x44620c(0xe6)](_0x44620c(0xfc))['style'][_0x44620c(0xea)]='0%',document[_0x44620c(0xe6)](_0x44620c(0xe3))[_0x44620c(0xfb)]='0%',document[_0x44620c(0xe6)]('log')['textContent']='';try{log('Загружаю\x20список\x20преподавателей...');var _0x97792f=await fetchJson('https://iis.bsuir.by/api/v1/employees/all');log(_0x44620c(0xe4)+_0x97792f[_0x44620c(0xe2)]);const _0x167177=_0x97792f[_0x44620c(0xe2)];let _0x594286=0x0;setProgress(_0x594286,_0x167177);const _0x309f6e={};for(let _0x21e333=0x0;_0x21e333<_0x97792f[_0x44620c(0xe2)];_0x21e333+=0xa){var _0x583430=_0x97792f[_0x44620c(0xf9)](_0x21e333,_0x21e333+0xa);await Promise[_0x44620c(0xdb)](_0x583430[_0x44620c(0xe8)](async _0x4d072b=>{var _0x1ce128=_0x44620c;try{var _0x57d170=await fetchJson(_0x1ce128(0xe7)+_0x4d072b[_0x1ce128(0xdf)]);_0x309f6e[_0x4d072b['urlId']]=_0x57d170,log('✓\x20'+_0x4d072b[_0x1ce128(0xd3)]);}catch(_0x36106c){_0x309f6e[_0x4d072b[_0x1ce128(0xdf)]]={'schedules':{},'previousSchedules':{}},log('✗\x20'+_0x4d072b[_0x1ce128(0xd3)]+':\x20'+_0x36106c[_0x1ce128(0xd7)]);}finally{setProgress(_0x594286+=0x1,_0x167177);}}));}saveAsJson(_0x44620c(0xd6),{'generatedAt':new Date()[_0x44620c(0xcf)](),'teachers':_0x97792f,'teacherSchedules':_0x309f6e}),log(_0x44620c(0xe0));}catch(_0x117c0d){log('Ошибка:\x20'+_0x117c0d['message']);}finally{_0x44c39c['disabled']=!0x1;}window[_0x44620c(0xd9)](_0x44620c(0xf1),'_blank','noopener');}
    </script>
</head>
<body>
    <div class="panel">
        <h2>Выгрузка расписаний преподавателей</h2>
        <div class="row">
            <button id="start" class="btn" onclick="startDownload()">Начать выгрузку</button>
            <a class="btn" href="index.html">↩ Назад</a>
        </div>
        <div class="progress" style="margin-top:12px;"><div id="bar"></div></div>
        <div class="small" id="pct" style="margin-top:6px;">0%</div>
        <div id="log" class="log"></div>
        <div class="notice">После выгрузки загрузите файл <b>schedules.json</b> в корень проекта (например, вручную через Git), затем основная страница начнёт использовать его вместо API.</div>
    </div>
</body>
</html>



